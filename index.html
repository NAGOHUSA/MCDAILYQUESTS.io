<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minecraft Daily Quest</title>
  <meta name="description" content="New vanilla Minecraft quest every day. No mods. Play in any world or seed. Vote once per day and climb the leaderboard." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1020; --panel:#111936; --accent:#31e081; --accent-2:#ffd24d; --text:#eef3ff; --muted:#9db0ff; --danger:#ff6b6b;
      --border:rgba(255,255,255,0.08);
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b1020 0%,#0d1230 100%);color:var(--text);font-family:Montserrat,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    a{color:var(--accent)}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#3cf19c 0%,#1cb0ff 100%);box-shadow:0 8px 30px rgba(49,224,129,.25)}
    h1{font-size:clamp(22px,4vw,32px);margin:0;font-weight:800;letter-spacing:0.3px}
    .tag{background:rgba(49,224,129,.12);border:1px solid rgba(49,224,129,.35);color:#9ff6c8;padding:4px 10px;border-radius:999px;font-size:12px}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media (min-width:980px){.grid{grid-template-columns:1.4fr .6fr}}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:18px 18px;box-shadow:0 8px 24px rgba(0,0,0,.25)}
    .card h2{margin:0 0 10px 0;font-size:20px}
    .muted{color:var(--muted)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{border:1px solid var(--border);border-radius:999px;padding:6px 10px;background:rgba(255,255,255,0.03)}
    .btn{appearance:none;border:1px solid var(--border);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));color:var(--text);padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn[disabled]{opacity:.5;cursor:not-allowed}
    .btn-accent{border-color:rgba(49,224,129,.55);background:linear-gradient(180deg,rgba(49,224,129,.18),rgba(49,224,129,.10))}
    .stars{display:flex;gap:8px;align-items:center}
    .star{font-size:28px;cursor:pointer;filter:drop-shadow(0 2px 6px rgba(0,0,0,.25))}
    .star.off{opacity:.35}
    .hr{height:1px;border:0;background:var(--border);margin:14px 0}
    .list{display:flex;flex-direction:column;gap:10px;max-height:350px;overflow:auto}
    .list a{display:flex;justify-content:space-between;gap:10px;border:1px solid var(--border);border-radius:10px;padding:10px 12px;text-decoration:none;background:rgba(255,255,255,.02)}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;background:#0c132b;border:1px solid var(--border);border-radius:6px;padding:2px 6px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;border-bottom:1px solid var(--border);text-align:left}
    tbody tr:hover{background:rgba(255,255,255,.03)}
    .hint{font-size:12px;opacity:.8}
    .success{color:#9ff6c8}
    .warn{color:#ff6b6b}
    footer{opacity:.7;margin-top:18px;font-size:12px}
    .step{display:flex;align-items:flex-start;gap:10px;margin:8px 0}
    .chk{accent-color:#31e081;min-width:18px;min-height:18px;margin-top:2px}
    .step.done span{text-decoration:line-through;opacity:.75}
    .lb-pill{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.03);font-size:11px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"></div>
      <div>
        <h1>Minecraft Daily Quest</h1>
        <div class="row"><span class="tag">Vanilla • No mods • Any seed</span></div>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: Today + Archive -->
      <div class="card">
        <h2>Today’s Quest <span id="questDate" class="muted"></span></h2>
        <div id="questLoading" class="muted">Loading today’s quest…</div>
        <div id="questBox" style="display:none">
          <div class="row" style="justify-content:space-between">
            <div class="row">
              <span class="pill" id="questBiome">Biome: —</span>
              <span class="pill" id="questReward">Reward: —</span>
              <span class="pill" id="questTheme">Theme: —</span>
            </div>
            <span class="pill">ID: <span id="questId" class="kbd"></span></span>
          </div>

          <h3 id="questTitle" style="margin:12px 0 8px 0"></h3>
          <div id="questLore" class="muted" style="white-space:pre-wrap"></div>

          <div class="hr"></div>
          <div>
            <strong>Steps:</strong>
            <div id="questSteps" style="margin-top:8px"></div>
            <div id="questProgress" class="hint" style="margin-top:6px"></div>
          </div>

          <div class="hr"></div>

          <div class="row" style="justify-content:space-between;align-items:center">
            <div>
              <div class="muted hint">Rate today’s quest (once per device):</div>
              <div class="stars" id="starRow" aria-label="Rate 1 to 5">
                <span class="star off" data-star="1">★</span>
                <span class="star off" data-star="2">★</span>
                <span class="star off" data-star="3">★</span>
                <span class="star off" data-star="4">★</span>
                <span class="star off" data-star="5">★</span>
              </div>
              <div id="voteMsg" class="hint" style="margin-top:6px"></div>
            </div>
            <button id="voteBtn" class="btn btn-accent">Submit Vote</button>
          </div>

          <div class="hr"></div>
          <div class="muted hint" id="statsLine">Ratings: —</div>
        </div>

        <div class="hr"></div>
        <h2>Archive</h2>
        <div class="hint muted">Browse previous quests and tap to preview.</div>
        <div id="archiveList" class="list" style="margin-top:8px">
          <div class="muted">Loading archive…</div>
        </div>
      </div>

      <!-- RIGHT: How it works + Leaderboard -->
      <div class="card">
        <h2>How it works</h2>
        <ul style="margin:8px 0 10px 18px;line-height:1.5">
          <li>A new <strong>vanilla</strong> quest drops every day. No commands, no mods—<em>works in any world/seed</em>.</li>
          <li>Check off steps as you go—progress is saved <strong>on your device</strong>.</li>
          <li>Rate with <strong>stars</strong> (optional; requires Supabase anon key & REST URL).</li>
          <li>See older quests in the <strong>Archive</strong> and the <strong>Top-Rated Leaderboard</strong>.</li>
        </ul>
        <div class="hr"></div>
        <h2>Top-Rated Leaderboard</h2>
        <div class="hint muted">If not configured, this section shows a friendly message.</div>
        <div id="lbWrap" style="margin-top:8px">
          <div class="muted">Loading leaderboard…</div>
        </div>
      </div>
    </div>

    <footer>
      Data: <span class="kbd">/quests/*.json</span> from GitHub • Votes via optional Supabase (insert-only RLS).
    </footer>
  </div>

  <!-- Optional Supabase config -->
  <script>
    window.SUPABASE_REST_URL = "";       // e.g. "https://YOUR_PROJECT.supabase.co/rest/v1"
    window.SUPABASE_ANON_KEY = "";       // public anon key
    window.SUPABASE_COMPAT_VOTES = false;
    window.SUPABASE_TABLE_RATINGS = "ratings";
    window.SUPABASE_VIEW_RATINGS_AGG = "ratings_aggregate";
    window.SUPABASE_TABLE_VOTES = "votes";
    window.SUPABASE_VIEW_VOTES_AGG = "votes_aggregate";
  </script>

  <!-- Frontend logic -->
  <script src="quest-ui.js"></script>
</body>
</html>
